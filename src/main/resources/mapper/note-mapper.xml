<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Note">

    <resultMap id="NoteResult" type="com.example.demo.dto.NoteDTO">
        <id property="id" column="id" />
        <result property="lng" column="lng" />
        <result property="lat" column="lat" />
        <result property="content" column="content" />
        <result property="createdAt" column="created_at" />
    </resultMap>

    <select id="getAll" resultMap="NoteResult">
        SELECT id, lng, lat, content, DATE_FORMAT(created_at, '%Y-%m-%d %H:%i:%s') AS created_at
        FROM notes
        ORDER BY created_at DESC
    </select>

    <insert id="save" parameterType="com.example.demo.dto.NoteDTO" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO notes (lng, lat, content)
        VALUES (#{lng}, #{lat}, #{content})
    </insert>

    <update id="update" parameterType="com.example.demo.dto.NoteDTO">
        UPDATE notes
        SET lng = #{lng}, lat = #{lat}, content = #{content}
        WHERE id = #{id}
    </update>

</mapper>